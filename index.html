<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width" initial-scale="1.0">
    <link rel="stylesheet" href="style.css">
    <title>Scheduling System</title>
</head>

<body>
    <nav>
        <a href="login.html" class="loginLink" id="loginNav">Login/Register</a>
        <a class="loginLink" id="logoutNav" style="display:none;">Logout</a>
    </nav>
    
    <!--This is just the intro section that's displayed on the index page.-->
    <section class="intro">
        <img src="scheduling-logo.png" id="profile-pic" style="width:100px;height:100px;border-radius:50%;">
        <h1>STUDENT SCHEDULING SYSTEM</h1>
        <p>
            This site contains the initial version of our scheduling system project. Many things may not be as good
            or look as good as they would in the final version, but the basic functionality should be present. Further
            improvements upon functionality, appearance, and various "under the hood" things(such as making code more
            efficient or clean without altering the appearance/functionality of the site) will follow in future releases
            of this site.
        </p>

        <!--Profile Picture Upload Section-->
        <div id="profile-upload">
            <label for="profile-image">Change Profile Picture:</label>
            <input type="file" id="profile-image" accept="image/*">
        </div>
    </section>

    <!--This is to create the "create schedule" button. -->
    <section id="content">
        <button type="button" name="entry-form">Click here to create schedule</button>
    </section>
    
    <table>
        <tr>
            <td>
                <div id="entry-form"> 
                    <form onsubmit="event.preventDefault();onFormSubmit();" autocomplete="off">
                        <div>
                            <label>Event Name*</label><label class="validation-error hide" id="eventValidationError">This field is required.</label>
                            <input type="text" name="event" id="event">
                        </div>
                        <div>
                            <label>Date</label>
                            <input type="date" name="date" id="date">
                        </div>
                        <div>
                            <label>Time</label>
                            <input type="time" name="time" id="time">
                        </div>
                        <div class="form-action-buttons">
                            <input type="submit" value="Submit" id="schedule-submit-button">
                        </div>
                    </form>
                </div>
            </td>
            <td>
                <table class="list" id="eventList">
                    <thead>
                        <tr>
                            <th>Event Name</th>
                            <th>Date</th>
                            <th>Time</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </td>
        </tr>
    </table>

    <!--This is very importnat it runs our script file.-->
    <script src="script.js"></script>
    <script>
        //This redirects them to the login page if they're not logged in.
        if (!localStorage.getItem("loggedIn")) {
            window.location.href = "login.html";
        }

        //This section switches between displaying the login and logout in the header.
        const loginNav = document.getElementById("loginNav");
        const logoutNav = document.getElementById("logoutNav");
        loginNav.style.display = "none";
        logoutNav.style.display = "inline";

        //When "Logout" is clicked, this sends them back to the login page.
        logoutNav.addEventListener("click", () => {
            localStorage.removeItem("loggedIn");
            window.location.href = "login.html";
        });

        //This is for the profile picture upload
        const profileInput = document.getElementById("profile-image");
        const profilePic = document.getElementById("profile-pic");

        // This loads the stored profile picture if it's available
        const storedImage = localStorage.getItem("profileImage");
        if(storedImage){
            profilePic.src = storedImage;
        }

        // This is what's used for when the usr chooses a new image!
        profileInput.addEventListener("change", function() {
            const file = this.files[0];
            if(file){
                const reader = new FileReader();
                reader.onload = function(e){
                    // Display the image
                    profilePic.src = e.target.result;
                    // Store the image in localStorage
                    localStorage.setItem("profileImage", e.target.result);
                }
                reader.readAsDataURL(file);
            }
        });
    </script>
</body>
</html>
